mixin form({ heading, submitText = 'Submit', cancelText = 'Cancel' })
  form(method='POST' :action='endpoint', @submit='submitted = true' enctype!=attributes.enctype class='px-5 py-6')
    h2(class='mb-5 text-lg')= heading
    div(class='mb-5')
      block
    div(class='flex justify-end gap-2')
      button(type='button' :disabled='submitted' @click='close' class='text-sm text-gray-700 px-3 py-2 bg-white hover:bg-gray-100 rounded-lg disabled:text-gray-400')
        | #{ cancelText }
      button(type='submit' :disabled='submitted' class='text-sm text-gray-700 px-3 py-2 bg-white hover:bg-gray-100 rounded-lg disabled:text-gray-400')
        | #{ submitText }

// overlay
div(
  x-cloak
  x-data='$store.modal'
  x-show='isOpen'
  x-transition.opacity
  @keydown.escape.window='close'
  class= 'fixed top-0 left-0 w-full h-full z-40 bg-gray-500/50 p-6 flex justify-center items-center'
)
  // modal body
  div(@click.outside='() => submitted || close()' class='relative bg-white max-w-[400px] max-h-full rounded-lg w-full')
    div(x-show= 'submitted' x-transition class='bg-white p-4 h-full w-full absolute top-0 left-0 flex flex-col justify-center items-center rounded-lg')
      div(class='loader')
      p(class='mt-3 text-center text-gray-700 text-sm') Your request is being processed... Please wait.

    template(x-if="operation === 'createChildFolder'")
      +form({ heading: 'New Folder', submitText: 'Create' })
        input(id='name' type="text" name='name' x-model='values.name' class='input-primary' required autocomplete='off')

    template(x-if="operation === 'renameFolder' || operation === 'renameFile'")
      +form({ heading: 'Rename' })
        input(id='name' type="text" name='name' x-model='values.name' class='input-primary' required autocomplete='off')

    template(x-if="operation === 'deleteFolder'")
      +form({ heading: 'Delete Folder', submitText: 'Delete' })
        p(class='text-gray-700 text-sm') 
          | Are you sure you want to delete the folder "
          span(x-text='values.name')
          | "? All content within the folder will also be deleted.

    template(x-if="operation === 'deleteFile'")
      +form({ heading: 'Delete File', submitText: 'Delete' })
        p(class='text-gray-700 text-sm')
          | Are you sure you want to delete the file "
          span(x-text='values.name')
          | "?

    template(x-if="operation === 'uploadFile'")
      +form({ heading: 'New File', submitText: 'Upload' })(enctype='multipart/form-data')
        input(
            type='file' 
            name='uploaded_file' 
            required 
            class='w-full text-gray-400 font-semibold text-sm bg-white border file:cursor-pointer cursor-pointer file:border-0 file:py-3 file:px-4 file:mr-4 file:bg-gray-100 file:hover:bg-gray-200 file:text-gray-500 rounded'
          )
